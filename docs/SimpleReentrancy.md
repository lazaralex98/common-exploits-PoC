# Solidity API

## Target

### balances

```solidity
mapping(address => uint256) balances
```

### deposit

```solidity
function deposit() public payable
```

Sends ETH and updates in-contract balance of sender.

### withdraw

```solidity
function withdraw() public payable
```

Withdraws all ETH the caller has in-contract as per their balance.
This is vulnerable to simple reentrancy and can be fixed by
changing the balance state before transfering the ETH.

## Attacker

### target

```solidity
contract Target target
```

An interface to the target that will allow us to call its functions.

### i

```solidity
uint256 i
```

Tracks how many times the receive function is called.

### constructor

```solidity
constructor(address _target) public
```

Set the target on deployment because we need it in storage
to be able to call it from the receive function.

### deposit

```solidity
function deposit() public payable
```

Deposit ETH into the target contract. This updates the balance and allows us to
have a certain amount of ETH sent to Attacker on each call to the withdraw function.

### attack

```solidity
function attack() public payable
```

Withdraw ETH from the target contract. This will call the receive function
and allows us to take over the control flow.

### receive

```solidity
receive() external payable
```

This is called when the target contract sends ETH to this contract.
We can use this to call the withdraw function again and again.
This is the reentrancy.

